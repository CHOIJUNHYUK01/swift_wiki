# ARC 메모리 관리

### 값 형식

Stack에 값이 저장된다.
값이 들어있는 스택의 스코프가 종료되면 메모리에서 자동으로 제거된다.

### 참조 형식

> 여기 메모리 관리가 필요하다.

Heap에 값이 저장된다. 주소는 Stack에 저장된다.
RC를 통해 메모리를 관리한다.
이를 자동으로 해주는 ARC 모델을 통해 관리된다.
클래스와 클로저가 여기에 속한다.

### ARC (Auto Reference Counting)

참조를 하고 있는 숫자를 의미한다.
해당 값이 0이 되야 메모리에서 해제된다.
서로 참조하고 있다면, 이게 순환 참조가 발생해 메모리 누수가 일어난다.

### weak vs unowned

> 둘 다 RC를 올리지 않는 키워드다.

하지만 weak은 nil로 값이 없을 때를 알려준다.
다만 unowned는 nil로 할당이 되지 않는다. 무조건 값이 있다는 보장이 있을 때만 사용해야 한다.
값이 없다면, 에러가 발생해 앱을 종료시킨다.

### 클로저 사용할 때 주의

캡처 리스트를 선언할 수 있다.
값 형식이 들어갔다면, 이제 변수의 주소가 아니라 값을 복사해 캡처한다.
다만, 이때 참조 타입을 캡처한다면 RC를 올린다.
이걸 주의해서 메모리 관리를 해야 한다.
